

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workflow Examples &mdash; haddock3 3.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=34bb78ad" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=acc74ff5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced features" href="tutorials/index.html" />
    <link rel="prev" title="Usage" href="USAGE.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            haddock3
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">A brief introduction to HADDOCK3</a></li>
<li class="toctree-l1"><a class="reference internal" href="INSTALL.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="USAGE.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Workflow Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#docking-antibody-antigen">docking-antibody-antigen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-nanobody-antigen">docking-nanobody-antigen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-dna">docking-protein-dna</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-glycan">docking-protein-glycan</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-homotrimer">docking-protein-homotrimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-ligand">docking-protein-ligand</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-ligand-shape">docking-protein-ligand-shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-peptide">docking-protein-peptide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-protein-protein">docking-protein-protein</a></li>
<li class="toctree-l2"><a class="reference internal" href="#refine-complex">refine-complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scoring">scoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docking-multiple-ambig">docking-multiple-ambig</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-analysis-tasks">general analysis tasks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/index.html">Advanced features</a></li>
<li class="toctree-l1"><a class="reference internal" href="clients/haddock.clis.html">Command-line interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/index.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to HADDOCK3</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/index.html">Library Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">haddock3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Workflow Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="workflow-examples">
<h1>Workflow Examples<a class="headerlink" href="#workflow-examples" title="Link to this heading"></a></h1>
<p>The HADDOCK3 <code class="docutils literal notranslate"><span class="pre">examples/</span></code> directory contains various subdirectories and config files
corresponding to different types of complexes, scenarios and data.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#docking-antibody-antigen">docking-antibody-antigen</a></p></li>
<li><p><a class="reference internal" href="#docking-nanobody-antigen">docking-nanobody-antigen</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-dna">docking-protein-DNA</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-glycan">docking-protein-glycan</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-homotrimer">docking-protein-homotrimer</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-ligand">docking-protein-ligand</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-ligand-shape">docking-protein-ligand-shape</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-peptide">docking-protein-peptide</a></p></li>
<li><p><a class="reference internal" href="#docking-protein-protein">docking-protein-protein</a></p></li>
<li><p><a class="reference internal" href="#refine-complex">refine-complex</a></p></li>
<li><p><a class="reference internal" href="#scoring">scoring</a></p></li>
<li><p><a class="reference internal" href="#docking-multiple-ambig">docking-multiple-ambig</a></p></li>
<li><p><a class="reference internal" href="#general-analysis-tasks">general analysis tasks</a></p></li>
</ol>
<p>Each directory contains both:</p>
<ul class="simple">
<li><p><strong>test</strong> runs config files (to test the various workflows, make sure the installation works and any changes to the code/scripts have not broken the machinery). Those are set up to run locally.</p></li>
<li><p><strong>full</strong> runs config files with recommended parameter settings. Those runs are set up to be executed in “batch” mode using slurm (the <code class="docutils literal notranslate"><span class="pre">...full.cfg</span></code>) files. Examples making use of MPI are also provided in some cases, together with an associated job file that should be submitted to the slurm batch system (<code class="docutils literal notranslate"><span class="pre">...full-mpi.cfg</span></code> and <code class="docutils literal notranslate"><span class="pre">...full-mpi.job</span></code>). Make sure to adapt the full config files to your own system.</p></li>
</ul>
<p>The following examples are currently provided:</p>
<section id="docking-antibody-antigen">
<h2>docking-antibody-antigen<a class="headerlink" href="#docking-antibody-antigen" title="Link to this heading"></a></h2>
<p>An antibody-antigen docking example making use only of the knowledge of the hypervariables (HV) loops on the antibody to guide the docking. This is the same complex used in our <a class="reference external" href="https://www.bonvinlab.org/education/HADDOCK24/HADDOCK24-antibody-antigen/">HADDOCK2.4 webserver tutorial</a>; refer to it for more details. Three different ways of using the knowledge of the HV loop residues are illustrated:</p>
<ul class="simple">
<li><p><strong>CDR-accessible</strong>: using ambiguous distance restraints (AIRs) between the HV loop residues and the solvent-accessible residues of the antigen. Those are defined in the <code class="docutils literal notranslate"><span class="pre">ambig.tbl</span></code> file provided in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory</p></li>
<li><p><strong>ranairCDR</strong>: using random AIRs sampled from the HV loops on the antibody and the solvent-accessible residues on the antigen. The random AIRs are used during the rigidbody docking sampling phase and replaced by contact AIRs during refinement.</p></li>
<li><p><strong>CDR-NMR-CSP</strong>: using ambiguous distance restraints (AIRs) between the HV loop residues and the epitope residues identified by NMR.</p></li>
</ul>
<p>Since antibodies consist of two separate chains, a few additional unambiguous restraints are defined between the antibody chains to keep them together during the flexible refinement stage. Those are defined in the <code class="docutils literal notranslate"><span class="pre">unambig.tbl</span></code> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory.</p>
<p>Three different protocols/workflows are illustrated:</p>
<ol class="arabic simple">
<li><p>10000 rigidbody docking models, selection of top500 and flexible refinement + EM of those (<a class="reference download internal" download="" href="_downloads/def03e5a2e87727569244cb5cc84651b/docking-antibody-antigen-CDR-accessible-full.cfg"><span class="xref download myst">docking-antibody-antigen-CDR-accessible-full.cfg</span></a> and <a class="reference download internal" download="" href="_downloads/cda883b5ce950f26a1ace13e0a016e05/docking-antibody-antigen-ranairCDR-full.cfg"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">docking-antibody-antigen-ranairCDR-full.cfg</span></code></span></a>)</p></li>
<li><p>10000 rigidbody docking models, FCC clustering and selection of max 20 models per cluster followed by flexible refinement and EM (<a class="reference download internal" download="" href="_downloads/9dc5796d1f916797b45b7b96e1996c90/docking-antibody-antigen-CDR-accessible-clt-full.cfg"><span class="xref download myst">docking-antibody-antigen-CDR-accessible-clt-full.cfg</span></a> and <a class="reference download internal" download="" href="_downloads/8568c7843caf61469b53ff2e62af5bd5/docking-antibody-antigen-ranairCDR-clt-full.cfg"><span class="xref download myst">docking-antibody-antigen-ranairCDR-clt-full.cfg</span></a>`).</p></li>
<li><p>1000 rigidbody docking models, selection of top200 and flexible refinement + EM of those (default sampling in the case in which the epitope has been determined by NMR: <a class="reference download internal" download="" href="_downloads/a37df39674ddefd0521b5eb4d6154276/docking-antibody-antigen-CDR-NMR-CSP-full.cfg"><span class="xref download myst">docking-antibody-antigen-CDR-NMR-CSP-full.cfg</span></a>)</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="docking-nanobody-antigen">
<h2>docking-nanobody-antigen<a class="headerlink" href="#docking-nanobody-antigen" title="Link to this heading"></a></h2>
<p>A nanobody-antigen docking example making use of different levels of knowledge about the antigen epitope.</p>
<p>The standard HADDOCK workflow is used for all the cases, with 1000 <code class="docutils literal notranslate"><span class="pre">rigidbody</span></code> docking models, selection of top200 for flexible refinement (<code class="docutils literal notranslate"><span class="pre">flexref</span></code>) + energy minimisation (<code class="docutils literal notranslate"><span class="pre">emref</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="docking-protein-dna">
<h2>docking-protein-dna<a class="headerlink" href="#docking-protein-dna" title="Link to this heading"></a></h2>
<p>A protein-DNA docking example making use of rather specific protein-DNA distance restraints defined in the <code class="docutils literal notranslate"><span class="pre">ambig.tbl</span></code> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory.</p>
<p>Three different protocols/workflows are illustrated:</p>
<ol class="arabic simple">
<li><p>1000 rigidbody docking models, selection of top200 and flexible refinement + EM of those (<a class="reference download internal" download="" href="_downloads/e659be735448e2b811611b101a61d63a/docking-protein-DNA-full.cfg"><span class="xref download myst">docking-protein-DNA-full.cfg</span></a>)</p></li>
<li><p>1000 rigidbody docking models, selection of top200 and flexible refinement + final refinement in explict solvent (water) of those (<a class="reference download internal" download="" href="_downloads/981d10bb5cb002897172db472ff248ff/docking-protein-DNA-mdref-full.cfg"><span class="xref download myst">docking-protein-DNA-mdref-full.cfg</span></a></p></li>
<li><p>1000 rigidbody docking models, FCC clustering and selection of max 20 models per cluster followed by flexible refinement and EM (<a class="reference internal" href="#../examples/examples/docking-protein-DNA/docking-protein-DNA-cltsel-full.cfg"><span class="xref myst">docking-protein-DNA-cltsel-full.cfg</span></a>).</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
<p><strong>Note</strong> the modified electrostatic treatment for DNA (<code class="docutils literal notranslate"><span class="pre">cdie</span></code> and <code class="docutils literal notranslate"><span class="pre">epsilon=78</span></code>) and the automatic definition of DNA restraints to maintain the double helix (<code class="docutils literal notranslate"><span class="pre">dnarest_on=true</span></code>).</p>
</section>
<section id="docking-protein-glycan">
<h2>docking-protein-glycan<a class="headerlink" href="#docking-protein-glycan" title="Link to this heading"></a></h2>
<p>A protein-glycan docking example making use of the knowledge of the binding site on the protein to guide the docking. The conformation of the glycan has been obtained from the <a class="reference external" href="http://glycam.org/">GLYCAM webserver</a>, while the structure of the protein is taken from the PDB in its unbound form. In the proposed workflows, a clustering step is always performed after initial docking stage, so as to increase the diversity of the ensemble of models to be refined. Three different workflows are illustrated:</p>
<ol class="arabic simple">
<li><p>1000 rigidbody docking models, RMSD clustering to select 50 clusters, flexible refinement of the top 5 models of each cluster, final RMSD clustering for cluster-based scoring (<a class="reference download internal" download="" href="_downloads/0890a1df3a4078e5678b94fae7b211ad/docking-protein-glycan-full.cfg"><span class="xref download myst">docking-protein-glycan-full.cfg</span></a>). The RMSD clustering assumes a good knowledge of the interface, as the user has to define the residues involved in the binding site by means of the resdic_ parameter.</p></li>
<li><p>1000 rigidbody docking models, interface-ligand-RMSD (<code class="docutils literal notranslate"><span class="pre">ilrmsd</span></code>) clustering to select 50 clusters, flexible refinement of the top 5 models of each cluster, final ilRMSD clustering for cluster-based scoring (<a class="reference download internal" download="" href="_downloads/b130d4230f3036f6bde47ab961ba1107/docking-protein-glycan-ilrmsd-full.cfg"><span class="xref download myst">docking-protein-glycan-ilrmsd-full.cfg</span></a>). The interface-ligand-RMSD clustering is a more general approach, as it does not require the user to define the residues involved in the binding site. The interface is automatically defined by the residues involved in the protein-glycan interaction in the input models.</p></li>
<li><p>500 flexible docking runs + final RMSD clustering for cluster-based scoring <a class="reference download internal" download="" href="_downloads/7a2ad5e37b3049d05c540bf5309a3f03/docking-flexref-protein-glycan-full.cfg"><span class="xref download myst">docking-flexref-protein-glycan-full.cfg</span></a>. In this case, the rigidbody docking is skipped and the docking is performed at the flexible refinement level. In this case the flexible refinement has more steps than usual (<code class="docutils literal notranslate"><span class="pre">mdsteps_rigid</span> <span class="pre">=</span> <span class="pre">5000</span></code>, <code class="docutils literal notranslate"><span class="pre">mdsteps_cool1</span> <span class="pre">=</span> <span class="pre">5000</span></code> and so on) and the glycan is defined as fully flexible (<code class="docutils literal notranslate"><span class="pre">fle_sta_1</span></code>, <code class="docutils literal notranslate"><span class="pre">fle_end_1</span></code>, <code class="docutils literal notranslate"><span class="pre">fle_seg_1</span></code>).</p></li>
</ol>
<p><strong>Note</strong> the modified weight of the van der Waals energy term for the scoring of the rigidbody docking models (<code class="docutils literal notranslate"><span class="pre">w_vdw</span> <span class="pre">=</span> <span class="pre">1.0</span></code>), as in the <a class="reference internal" href="#docking-protein-ligand">protein-ligand example</a>.</p>
</section>
<section id="docking-protein-homotrimer">
<h2>docking-protein-homotrimer<a class="headerlink" href="#docking-protein-homotrimer" title="Link to this heading"></a></h2>
<p>A protein homotrimer with C3 symmetry docking example making use of bioinformatics interface predictions from our <a class="reference external" href="https://wenmr.science.uu.nl/whiscy/">Whiscy webserver</a> defined in the <a class="reference download internal" download="" href="_downloads/020be12e9f40c9baaf6acda0849017e1/1qu9_whiscy_air.tbl"><span class="xref download myst">1qu9_whiscy_air.tbl</span></a> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory. Note that this is a bound docking example since the protein monomers used for docking are taken from the crystal structure of the homotrimer. The workflow does however perform a flexible refinement of the models, which might lead to deviations from the bound conformation.</p>
<p>The <a class="reference download internal" download="" href="_downloads/236bd1c3782afe259e974e197a048ba0/docking-protein-homotrimer-full.cfg"><span class="xref download myst">docking-protein-homotrimer-full.cfg</span></a> workflow consists of the generation of 2000 rigidbody docking models, selection of top200 and flexible refinement + EM of those. C3 and non-crystallographic (NCS) symmetry restraints are defined to guide the docking.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="docking-protein-ligand">
<h2>docking-protein-ligand<a class="headerlink" href="#docking-protein-ligand" title="Link to this heading"></a></h2>
<p>A protein-ligand docking example making use of the knowledge of the binding site on the protein to guide the docking.</p>
<p>As explained in our <a class="reference external" href="https://www.bonvinlab.org/education/HADDOCK24/HADDOCK24-binding-sites/">protein-ligand HADDOCK2.4 tutorial</a>, in the rigidbody docking phase all residues of the binding site are defined as active to draw the ligand into it (the corresponding AIRs are defined in the <a class="reference download internal" download="" href="_downloads/a300d174b05e98a251f758c90ccfabf1/ambig-active-rigidbody.tbl"><span class="xref download myst">ambig-active-rigidbody.tbl</span></a> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). For the flexible refinement only the ligand is defined as active and the binding site as passive to allow the ligand to explore the binding site (the corresponding AIRs are defined in the <a class="reference download internal" download="" href="_downloads/d7deefbb1c7f7dde0270f72746bc8d98/ambig-passive.tbl"><span class="xref download myst">ambig-passive.tbl</span></a> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory).</p>
<p>The <a class="reference download internal" download="" href="_downloads/5efbc2050ea6f9470237e58ed40b7774/docking-protein-ligand-full.cfg"><span class="xref download myst">docking-protein-ligand-full.cfg</span></a> workflow consists of the generation of 1000 rigidbody docking models, selection of top200 and flexible refinement of those.</p>
<p><strong>Note</strong> the modified weight of the van der Waals energy term for the scoring of the rigidbody docking models (<code class="docutils literal notranslate"><span class="pre">w_vdw</span> <span class="pre">=</span> <span class="pre">1.0</span></code>) and the skipping of the high temperature first two stages of the simulated annealing protocol during the flexible refinement (<code class="docutils literal notranslate"><span class="pre">mdsteps_rigid</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">mdsteps_cool1</span> <span class="pre">=</span> <span class="pre">0</span></code>). Parameter and topology files must be provided for the ligand (<code class="docutils literal notranslate"><span class="pre">ligand_param_fname</span> <span class="pre">=</span> <span class="pre">&quot;data/ligand.param&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">ligand_top_fname</span> <span class="pre">=</span> <span class="pre">&quot;data/ligand.top&quot;</span></code>). Those were obtained with a local version of PRODRG (<a class="reference external" href="http://scripts.iucr.org/cgi-bin/paper?S0907444904011679">Schüttelkopf and van Aalten Acta Crystallogr. D 60, 1355−1363 (2004)</a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="docking-protein-ligand-shape">
<h2>docking-protein-ligand-shape<a class="headerlink" href="#docking-protein-ligand-shape" title="Link to this heading"></a></h2>
<p>A protein-ligand docking example making use of the knowledge of a template ligand (a ligand similar to the ligand we want to dock and bind to the same receptor). The template ligand information is used in the form of shape consisting of dummy beads and positioned within the binding site to which distance restraints are defined. More details about the method and the performance of the protocol when benchmarked on a fully unbound dataset
can be seen in our freely available <a class="reference external" href="https://pubs.acs.org/doi/full/10.1021/acs.jcim.1c00796">paper on JCIM</a>.</p>
<p>As explained in our <a class="reference external" href="https://www.bonvinlab.org/education/HADDOCK24/shape-small-molecule/">shape small molecule HADDOCK2.4 tutorial</a>, during the docking and refinement the protein and the shape are kept in their original positions (see the <code class="docutils literal notranslate"><span class="pre">mol_fix_origin_X</span></code> parameters in the config file) and ambiguous distance restraints between the ligand and the shape beads are defined. (The corresponding AIRs are defined in the <code class="docutils literal notranslate"><span class="pre">shape-restraints-from-shape-1.tbl</span></code> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). This is effectively a three body docking. For the ligand an ensemble of 10 different conformations is provided as starting point for the docking (<code class="docutils literal notranslate"><span class="pre">ligand-ensemble.pdb</span></code> in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). Please refer to our <a class="reference external" href="https://www.bonvinlab.org/education/HADDOCK24/shape-small-molecule/">shape small molecule tutorial</a> for information on how to generate such an ensemble.</p>
<p>The <a class="reference download internal" download="" href="_downloads/93b2231b61ed6527618ebc1ef3cd0765/docking-protein-ligand-shape-full.cfg"><span class="xref download myst">docking-protein-ligand-shape-full.cfg</span></a> workflow consists of the generation of 1000 rigidbody docking models with the protein and shape kept in their origin position, selection of top200 and flexible refinement of those.</p>
<p><strong>Note</strong> the modified weight of the van der Waals energy term for the scoring of the rigidbody docking models (<code class="docutils literal notranslate"><span class="pre">w_vdw</span> <span class="pre">=</span> <span class="pre">1.0</span></code>). To allow the ligand to penetrate better into the binding site the intermolecular energy components are scaled down during the rigidbody docking phase (<code class="docutils literal notranslate"><span class="pre">inter_rigid</span> <span class="pre">=</span> <span class="pre">0.001</span></code>). As for the protein-ligand example, parameter and topology files must be provided for the ligand (<code class="docutils literal notranslate"><span class="pre">ligand_param_fname</span> <span class="pre">=</span> <span class="pre">&quot;data/ligand.param&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">ligand_top_fname</span> <span class="pre">=</span> <span class="pre">&quot;data/ligand.top&quot;</span></code>). Those were obtained with a local version of PRODRG (<a class="reference external" href="http://scripts.iucr.org/cgi-bin/paper?S0907444904011679">Schüttelkopf and van Aalten Acta Crystallogr. D 60, 1355−1363 (2004)</a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="docking-protein-peptide">
<h2>docking-protein-peptide<a class="headerlink" href="#docking-protein-peptide" title="Link to this heading"></a></h2>
<p>The protein-peptide docking example makes use of the knowledge of the binding site on the protein to guide the docking. The active site residues are defined as active and the peptide as passive (the corresponding AIRs are defined in the <code class="docutils literal notranslate"><span class="pre">ambig.tbl</span></code> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). This example follows the protocol described in our protein-peptide docking article (<a class="reference external" href="https://dx.plos.org/10.1371/journal.pone.0058769">Trellet et. al. PLoS ONE 8, e58769 (2013)</a>). For the peptide, an ensemble of three conformations (alpha-helix, polyproline-II and extended) is provided as starting point for the docking. Those were built using PyMol (instructions on how to do that can be found <a class="reference external" href="https://www.bonvinlab.org/education/molmod_online/simulation/#preparing-the-system">here</a>).</p>
<p>Three different workflows are illustrated:</p>
<ol class="arabic simple">
<li><p>3000 rigidbody docking models, selection of top400 and flexible refinement + EM of those (<a class="reference download internal" download="" href="_downloads/e41ad0a8bdd3d00032658d0f9de3ab6b/docking-protein-peptide-full.cfg"><span class="xref download myst">docking-protein-peptide-full.cfg</span></a></p></li>
<li><p>3000 rigidbody docking models, selection of top400 and flexible refinement + final refinement in explicit solvent (water) of those (<a class="reference download internal" download="" href="_downloads/039bcdf36d0be5c95294c1b62e51c3f2/docking-protein-peptide-mdref-full.cfg"><span class="xref download myst">docking-protein-peptide-mdref-full.cfg</span></a></p></li>
<li><p>3000 rigidbody docking models, FCC clustering and selection of max 20 models per cluster followed by flexible refinement and EM (<a class="reference download internal" download="" href="_downloads/b0ec20829f34bb2531de0d1e22b8d911/docking-protein-peptide-cltsel-full.cfg"><span class="xref download myst">docking-protein-peptide-cltsel-full.cfg</span></a>).</p></li>
</ol>
<p><strong>Note</strong> how the peptide is defined as fully flexible for the refinement phase (<code class="docutils literal notranslate"><span class="pre">fle_sta_1</span></code>, <code class="docutils literal notranslate"><span class="pre">fle_end_1</span></code>, <code class="docutils literal notranslate"><span class="pre">fle_seg_1</span></code>) and dihedral angle restraints are automatically defined to maintain secondary structure elements (<code class="docutils literal notranslate"><span class="pre">ssdihed</span> <span class="pre">=</span> <span class="pre">&quot;alphabeta&quot;</span></code>)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="docking-protein-protein">
<h2>docking-protein-protein<a class="headerlink" href="#docking-protein-protein" title="Link to this heading"></a></h2>
<p>The protein-protein docking example makes use of the NMR chemical shift perturbation data providing information on the residues of binding site to guide the docking. The NMR-identified residues are defined as active with their surface neighbors as passive (the corresponding AIRs are defined in the <a class="reference download internal" download="" href="_downloads/f9b8a2fea90919b117c56e8fff7750e6/e2a-hpr_air.tbl"><span class="xref download myst">e2a-hpr_air.tbl</span></a> file in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). This system is the same as described in our <a class="reference external" href="https://www.bonvinlab.org/education/HADDOCK24/HADDOCK24-protein-protein-basic/">HADDOCK2.4 basic protein-protein docking tutorial</a>. For the second molecule (HPR), an ensemble of 10 conformations (taken from the NMR solution structure of this protein) is used as starting point for the docking. Refer to above tutorial for more details about the system and restraints.</p>
<p>Three different workflows are illustrated:</p>
<ol class="arabic simple">
<li><p>1000 rigidbody docking models, selection of top200 and flexible refinement + EM of those (<a class="reference download internal" download="" href="_downloads/ec7b452fb97e5b03fa93f5629ee3aea7/docking-protein-protein-full.cfg"><span class="xref download myst">docking-protein-protein-full.cfg</span></a>)</p></li>
<li><p>1000 rigidbody docking models, selection of top200 and flexible refinement + final refinement in explicit solvent (water) of those (<a class="reference download internal" download="" href="_downloads/f9a251d2d2015705bc20780aa5567d99/docking-protein-protein-mdref-full.cfg"><span class="xref download myst">docking-protein-protein-mdref-full.cfg</span></a>)</p></li>
<li><p>1000 rigidbody docking models, FCC clustering and selection of max 20 models per cluster followed by flexible refinement and EM (<a class="reference download internal" download="" href="_downloads/f10ecf8e3427256959c46eb1d5ce459e/docking-protein-protein-cltsel-full.cfg"><span class="xref download myst">docking-protein-protein-cltsel-full.cfg</span></a>).</p></li>
</ol>
<p>In this example all parameters are left to their default settings, except for manually defining the histidines protonation states.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="refine-complex">
<h2>refine-complex<a class="headerlink" href="#refine-complex" title="Link to this heading"></a></h2>
<p>This example illustrates the refinement of a complex. In this case (workflow <a class="reference download internal" download="" href="_downloads/430b378fe46e4bab5b2a7ab218b93b78/refine-complex-test.cfg"><span class="xref download myst">refine-complex-test.cfg</span></a>) the molecules are kept in their original positions and the complex is subjected to a short flexible refinement in explicit solvent with the <code class="docutils literal notranslate"><span class="pre">mdref</span></code> module. The same complex as for the <code class="docutils literal notranslate"><span class="pre">docking-protein-protein</span></code> example is used. The molecules are defined separately in the config file (and could consist each of an ensemble, provided the two ensembles have exactly the same number of models).</p>
<p>In this example all parameters are left to their default settings, except for manually defining the histidines’ protonation states and setting the <code class="docutils literal notranslate"><span class="pre">sampling_factor</span></code> to 10, which means that from each starting complex 10 models will be generated with different random seeds for initiating the molecular dynamics phase.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at the end to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="scoring">
<h2>scoring<a class="headerlink" href="#scoring" title="Link to this heading"></a></h2>
<p>This example illustrates the use of HADDOCK3 for scoring purposes. In contrast to HADDOCK2.4, HADDOCK3 can score a heterogenous set of complexes within one run/workflow. In this example, four different types of complexes are scored within the same workflow:</p>
<ul class="simple">
<li><p>an ensemble of 5 models taken from CAPRI Target161</p></li>
<li><p>a protein-DNA complex (model taken from our protein-DNA docking example)</p></li>
<li><p>two models of a protein-protein complex (taken from our protein-protein docking example)</p></li>
<li><p>a homotrimer model (taken from our protein-homotrimer docking examples)</p></li>
</ul>
<p>Two scoring workflows are illustrated:</p>
<ol class="arabic simple">
<li><p>Only a short energy minimisation is performed on each model (<a class="reference download internal" download="" href="_downloads/b86f185deca79f917f322b5255087a9a/emscoring-test.cfg"><span class="xref download myst">emscoring-test.cfg</span></a>).</p></li>
<li><p>A short molecular dynamics simulation in explicit solvent (water) is performed on each model. In that case contact AIRs (<code class="docutils literal notranslate"><span class="pre">contactairs</span> <span class="pre">=</span> <span class="pre">true</span></code>), dihedral angle restraints on secondary structure element (<code class="docutils literal notranslate"><span class="pre">ssdihed</span> <span class="pre">=</span> <span class="pre">alphabeta</span></code>) and DNA restraints (<code class="docutils literal notranslate"><span class="pre">dnarest_on</span> <span class="pre">=</span> <span class="pre">true</span></code>) are automatically defined (<a class="reference download internal" download="" href="_downloads/25288c023c74262ef43067da6a849647/mdscoring-test.cfg"><span class="xref download myst">mdscoring-test.cfg</span></a>).</p></li>
<li><p>An example scoring pipeline using in the CAPRI55 competition (<a class="reference download internal" download="" href="_downloads/b5bf1898c3686ec734ffae7e85f369d8/capri-scoring-test.cfg"><span class="xref download myst">capri-scoring-test.cfg</span></a>), where energy minimisation is followed by FCC clustering and selection of the top 2 models per cluster. Then a short molecular dynamics simulation in explicit solvent (water) is performed on each model and the models are clustered again.</p></li>
</ol>
<p>The model listings with their associated HADDOCK scores can be found in a <code class="docutils literal notranslate"><span class="pre">.tsv</span></code> file in the stage 01 directory of the respective runs.</p>
</section>
<section id="docking-multiple-ambig">
<h2>docking-multiple-ambig<a class="headerlink" href="#docking-multiple-ambig" title="Link to this heading"></a></h2>
<p>This example shows how to use HADDOCK3 when several restraint files are available. The example (<a class="reference download internal" download="" href="_downloads/bff81a5ff217e7c593fae796b3001e07/docking-multiple-tbls-test.cfg"><span class="xref download myst">docking-multiple-tbls-test.cfg</span></a>) is built upon the results obtained running <a class="reference external" href="https://github.com/haddocking/arctic3d">arctic3d</a> on two proteins forming the complex <code class="docutils literal notranslate"><span class="pre">2GAF</span></code>. The presence of multiple interfaces in both structures allows to define several <code class="docutils literal notranslate"><span class="pre">.tbl</span></code> ambiguous restraint files to be used in the calculations. At first, these files must be compressed in a <code class="docutils literal notranslate"><span class="pre">.tbl.tgz</span></code> archive. During the workflow, the HADDOCK3 machinery unzips the archive and evenly assigns each <code class="docutils literal notranslate"><span class="pre">.tbl</span></code> file to a number of models to be generated. Even if only one sixth of the restraint files contain reasonable information on the interface, HADDOCK3 is still able to retrieve good docking models in the best-scoring positions.</p>
<p><strong>Note</strong> how the information about restraint files is propagated during the workflow (<code class="docutils literal notranslate"><span class="pre">previous_ambig</span> <span class="pre">=</span> <span class="pre">true</span></code> for <code class="docutils literal notranslate"><span class="pre">flexref</span></code> and <code class="docutils literal notranslate"><span class="pre">emref</span></code> modules), so that each model is always refined with its corresponding <code class="docutils literal notranslate"><span class="pre">.tbl</span></code> file.</p>
<p>Importantly, in the <a class="reference download internal" download="" href="_downloads/c0325ac11ffcd6d4180c6f1758ad6e2d/docking-multiple-tbls-clt-full.cfg"><span class="xref download myst">docking-multiple-tbls-clt-full.cfg</span></a> example the clustering is performed right after the <code class="docutils literal notranslate"><span class="pre">rigidbody</span></code> module, so as to lump together solutions resulting from the application of different sets of restraints.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caprieval</span></code> module is called at various stages during the workflow to assess the quality of the models with respect to the known reference structure.</p>
</section>
<section id="general-analysis-tasks">
<h2>general analysis tasks<a class="headerlink" href="#general-analysis-tasks" title="Link to this heading"></a></h2>
<p>In the <code class="docutils literal notranslate"><span class="pre">analysis</span></code> directory, a few examples of how to perform general analysis tasks are provided. These workflows aim at showing how HADDOCK3 can be used outside the scope of docking and refinement to analyse structures and models coming from different sources (e.g. Alphafold2). These example workflows include:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/85161af7796a53456d90fd4d3cb85054/alascan-test.cfg"><span class="xref download myst">alascan-test.cfg</span></a>: an example of how to perform alanine scanning on a protein-protein complex.</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/1586dc8137f4ea0e908ee6c204ef1699/contmap-test.cfg"><span class="xref download myst">contmap-test.cfg</span></a>: an example of how to generate contact maps from a set of models.</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/7dde08d2ca8bf3d2627a9d157b60d830/topoaa-caprieval-test.cfg"><span class="xref download myst">topoaa-caprieval-test.cfg</span></a>: an example of how to run a CAPRI-like (<code class="docutils literal notranslate"><span class="pre">caprieval</span></code>) analysis on an ensemble of models.</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/78de8bceb012ea06c36cdc151b589943/topoaa-clustfcc-test.cfg"><span class="xref download myst">topoaa-clustfcc-test.cfg</span></a>: an example of how to run a FCC clustering analysis on an ensemble of models.</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/b084180ad96e86878e7cbc236b0046b8/topoaa-ilrmsdmatrix-clustrmsd-test.cfg"><span class="xref download myst">topoaa-ilrmsdmatrix-clustrmsd-test.cfg</span></a>: an example of how to run a ilRMSD matrix clustering analysis on an ensemble of models.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="USAGE.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorials/index.html" class="btn btn-neutral float-right" title="Advanced features" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, BonvinLab.
      <span class="lastupdated">Last updated on Sep 04, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>