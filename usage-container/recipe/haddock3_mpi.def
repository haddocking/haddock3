Bootstrap: docker
From: ubuntu:22.04

%labels
    Maintainer   Shantanu Khatri
    Description  "MPI-ready HADDOCK3 + mpi4py container"

%environment
    export PATH=/usr/local/bin:$PATH
    export LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/openmpi/lib:$LD_LIBRARY_PATH

%post
    # Install core dependencies and MPI
    apt-get update && apt-get install -y \
        wget git build-essential cmake gfortran \
        libfftw3-dev libxml2-dev zlib1g-dev \
        openmpi-bin libopenmpi-dev \
        python3 python3-pip \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

    # Install Python packages
    pip3 install --no-cache-dir --upgrade pip \
        mpi4py haddock3

%runscript
    echo "Welcome to the MPI-ready HADDOCK3 container."
    exec "$@"
